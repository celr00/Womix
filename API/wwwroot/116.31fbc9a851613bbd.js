"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[116],{4116:(W,g,i)=>{i.r(g),i.d(g,{AccountModule:()=>V});var d=i(6895),l=i(2559),n=i(433),e=i(1571),m=i(5329),p=i(8909),f=i(7185),v=i(4015),Z=i(4897);function S(s,r){if(1&s&&(e.TgZ(0,"div",3)(1,"h3"),e._uU(2,"Address"),e.qZA(),e.TgZ(3,"div",11),e._UZ(4,"app-text-input",5),e.qZA(),e.TgZ(5,"div",12),e._UZ(6,"app-text-input",5),e.qZA(),e.TgZ(7,"div",13),e._UZ(8,"app-text-input",5),e.qZA(),e.TgZ(9,"div",14),e._UZ(10,"app-text-input",5),e.qZA(),e.TgZ(11,"div",15),e._UZ(12,"app-text-input",5),e.qZA()()),2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("label","Number")("formControl",t.userForm.controls.appUserAddress.get("address").get("number")),e.xp6(2),e.Q6J("label","Street")("formControl",t.userForm.controls.appUserAddress.get("address").get("street")),e.xp6(2),e.Q6J("label","City")("formControl",t.userForm.controls.appUserAddress.get("address").get("city")),e.xp6(2),e.Q6J("label","State")("formControl",t.userForm.controls.appUserAddress.get("address").get("state")),e.xp6(2),e.Q6J("label","Zipcode")("formControl",t.userForm.controls.appUserAddress.get("address").get("zipcode"))}}function F(s,r){if(1&s&&(e.TgZ(0,"div",2)(1,"div",3)(2,"div",4),e._UZ(3,"app-text-input",5),e.qZA(),e.TgZ(4,"div",4),e._UZ(5,"app-text-input",5),e.qZA(),e.TgZ(6,"div",6),e._UZ(7,"app-date-picker",5),e.qZA(),e.TgZ(8,"div",6),e._UZ(9,"app-text-input",5),e.qZA()(),e.TgZ(10,"div",3)(11,"h3"),e._uU(12,"Social media"),e.qZA(),e.TgZ(13,"div",7),e._UZ(14,"app-text-input",5),e.qZA(),e.TgZ(15,"div",7),e._UZ(16,"app-text-input",5),e.qZA()(),e.YNc(17,S,13,10,"div",8),e.TgZ(18,"button",9),e._uU(19,"Save changes "),e._UZ(20,"i",10),e.qZA()()),2&s){const t=e.oxw();e.xp6(3),e.Q6J("label","First name")("formControl",t.userForm.controls.firstName),e.xp6(2),e.Q6J("label","Last name")("formControl",t.userForm.controls.lastName),e.xp6(2),e.Q6J("label","Birth date")("formControl",t.userForm.controls.dateOfBirth),e.xp6(2),e.Q6J("label","Phone number")("formControl",t.userForm.controls.phoneNumber),e.xp6(5),e.Q6J("label","Facebook")("formControl",t.userForm.controls.facebook),e.xp6(2),e.Q6J("label","Instagram")("formControl",t.userForm.controls.instagram),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.appUserAddress.get("address")),e.xp6(1),e.Q6J("disabled",!t.userForm.dirty||t.userForm.invalid)}}let w=(()=>{class s{constructor(t,o,c,a,u,h){this.accountService=t,this.fb=o,this.route=c,this.bcService=a,this.toastr=u,this.router=h,this.userForm=new n.cw({}),this.user={},this.maxDate=new Date,this.bcService.set("@editProfileTitle","Edit Profile")}ngOnInit(){this.loadUser(),this.maxDate.setFullYear(this.maxDate.getFullYear()-18)}onSubmit(){this.accountService.update(this.userForm.value).subscribe({next:t=>{this.user=t,this.userForm.reset(),this.userForm.patchValue(t),this.toastr.success("User updated successfully")},error:()=>{}})}loadUser(){this.accountService.getUserEntity().subscribe({next:t=>{this.user=t},complete:()=>{this.initForm(this.user.dateOfBirth)}})}initForm(t){this.userForm=this.fb.group({firstName:["",[n.kI.required]],lastName:["",[n.kI.required]],dateOfBirth:[t,[n.kI.required]],facebook:["",[n.kI.required]],instagram:["",[n.kI.required]],phoneNumber:["",[n.kI.required]],appUserPhoto:this.fb.group({userId:["",[n.kI.required]],photoId:["",[n.kI.required]],photo:this.fb.group({url:["",[n.kI.required]],id:["",[n.kI.required]]})}),appUserAddress:this.fb.group({userId:["",[n.kI.required]],addressId:["",[n.kI.required]],address:this.fb.group({number:["",[n.kI.required]],street:["",[n.kI.required]],city:["",[n.kI.required]],state:["",[n.kI.required]],zipcode:["",[n.kI.required]],id:["",[n.kI.required]]})})}),this.userForm.patchValue(this.user)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(m.B),e.Y36(n.qu),e.Y36(l.gz),e.Y36(p.pm),e.Y36(f._W),e.Y36(l.F0))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-edit"]],decls:2,vars:2,consts:[[1,"mb-4",3,"formGroup","ngSubmit"],["class","container-fluid container-md",4,"ngIf"],[1,"container-fluid","container-md"],[1,"row"],[1,"col-12","col-sm-6","col-md-4","col-lg-4"],[3,"label","formControl"],[1,"col-12","col-sm-6","col-md-4","col-lg-3"],[1,"col-12","col-sm-6","col-md-5","col-lg-4"],["class","row",4,"ngIf"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"fa","fa-floppy-o","ms-2"],[1,"col-4","col-sm-3","col-md-3","col-lg-2"],[1,"col-8","col-sm-9","col-md-4","col-lg-3"],[1,"col-12","col-sm-7","col-md-5","col-lg-4"],[1,"col-8","col-sm-5","col-md-4","col-lg-3"],[1,"col-4","col-sm-4","col-md-3","col-lg-2"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.YNc(1,F,21,14,"div",1),e.qZA()),2&t&&(e.Q6J("formGroup",o.userForm),e.xp6(1),e.Q6J("ngIf",o.user))},dependencies:[d.O5,v.t,Z.L,n._Y,n.JJ,n.JL,n.oH,n.sg]}),s})();var b=i(1106);let T=(()=>{class s{constructor(t){this.accountService=t,this.user={}}ngOnInit(){this.loadUser()}loadUser(){this.accountService.getUser().subscribe({next:t=>{this.user=t}})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(m.B))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-home"]],decls:1,vars:2,consts:[[3,"user","fromAccount"]],template:function(t,o){1&t&&e._UZ(0,"app-user-card",0),2&t&&e.Q6J("user",o.user)("fromAccount",!0)},dependencies:[b.r]}),s})(),y=(()=>{class s{constructor(t,o,c,a){this.bcService=t,this.fb=o,this.accountService=c,this.toastr=a,this.passwordForm=new n.cw({}),this.complexPassword="(?=^.{6,255}$)((?=.*d)(?=.*[A-Z])(?=.*[a-z])|(?=.*d)(?=.*[^A-Za-z0-9])(?=.*[a-z])|(?=.*[^A-Za-z0-9])(?=.*[A-Z])(?=.*[a-z])|(?=.*d)(?=.*[A-Z])(?=.*[^A-Za-z0-9]))^.*",this.bcService.set("@changePassword","Change password")}ngOnInit(){this.initForm()}initForm(){this.passwordForm=this.fb.group({currentPassword:["",[n.kI.required,n.kI.minLength(8),n.kI.maxLength(60)]],newPassword:["",[n.kI.required,n.kI.minLength(8),n.kI.maxLength(60),n.kI.pattern(this.complexPassword)]],repeatNewPassword:["",[n.kI.required,n.kI.minLength(8),n.kI.maxLength(60),this.matchValues("newPassword")]]}),this.passwordForm.controls.newPassword.valueChanges.subscribe({next:()=>this.passwordForm.controls.repeatNewPassword.updateValueAndValidity()})}matchValues(t){return o=>o.value===o.parent?.get(t)?.value?null:{notMatching:!0}}onSubmit(){this.accountService.resetPassword(this.passwordForm.value).subscribe({next:()=>{this.toastr.success("Password changed successfully"),this.passwordForm.reset()},error:()=>{}})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(p.pm),e.Y36(n.qu),e.Y36(m.B),e.Y36(f._W))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-change-password"]],decls:8,vars:11,consts:[[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-12","col-sm-10","col-md-6","col-lg-4"],[3,"label","formControl","type"],["type","submit",1,"btn","btn-success",3,"disabled"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return o.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2),e._UZ(3,"app-text-input",3)(4,"app-text-input",3)(5,"app-text-input",3),e.qZA()(),e.TgZ(6,"button",4),e._uU(7,"Submit"),e.qZA()()),2&t&&(e.Q6J("formGroup",o.passwordForm),e.xp6(3),e.Q6J("label","Current password")("formControl",o.passwordForm.controls.currentPassword)("type","password"),e.xp6(1),e.Q6J("label","New password")("formControl",o.passwordForm.controls.newPassword)("type","password"),e.xp6(1),e.Q6J("label","Repeat password")("formControl",o.passwordForm.controls.repeatNewPassword)("type","password"),e.xp6(1),e.Q6J("disabled",o.passwordForm.invalid))},dependencies:[v.t,n._Y,n.JJ,n.JL,n.oH,n.sg]}),s})();var C=i(1584);function U(s,r){if(1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-user-card",1),e.qZA()),2&s){const t=r.$implicit;e.xp6(1),e.Q6J("user",t)}}let M=(()=>{class s{constructor(t){this.userService=t,this.users=[]}ngOnInit(){this.loadSavedProfiles()}loadSavedProfiles(){this.userService.getSavedUsers().subscribe({next:t=>{this.users=t}})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(C.K))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-saved-profiles"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"user"]],template:function(t,o){1&t&&e.YNc(0,U,2,1,"div",0),2&t&&e.Q6J("ngForOf",o.users)},dependencies:[d.sg,b.r]}),s})(),I=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-products"]],decls:1,vars:0,template:function(t,o){1&t&&e._UZ(0,"router-outlet")},dependencies:[l.lC]}),s})(),J=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-services"]],decls:1,vars:0,template:function(t,o){1&t&&e._UZ(0,"router-outlet")},dependencies:[l.lC]}),s})();var P=i(5861),Q=i(4407),Y=i(5079),x=i(2340),N=i(1135),A=i(5698),O=i(529),E=i(9978);let k=(()=>{class s{constructor(t,o){this.http=t,this.busyService=o,this.baseUrl=x.N.apiUrl,this.hubUrl=x.N.hubUrl,this.messageThreadSource=new N.X([]),this.messageThread$=this.messageThreadSource.asObservable()}createHubConnection(t,o){this.busyService.busy(),this.hubConnection=(new Q.s).withUrl(this.hubUrl+"message?user="+o,{accessTokenFactory:()=>t.token,transport:Y.n.WebSockets}).withAutomaticReconnect().build(),this.hubConnection.start().catch(c=>console.log(c)).finally(()=>this.busyService.idle()),this.hubConnection.on("ReceiveMessageThread",c=>{this.messageThreadSource.next(c)}),this.hubConnection.on("UpdatedGroup",c=>{c.connections.some(a=>a.username===o)&&this.messageThread$.pipe((0,A.q)(1)).subscribe({next:a=>{a.forEach(u=>{u.dateRead||(u.dateRead=new Date(Date.now()))}),this.messageThreadSource.next([...a])}})}),this.hubConnection.on("NewMessage",c=>{this.messageThread$.pipe((0,A.q)(1)).subscribe({next:a=>{this.messageThreadSource.next([...a,c])}})})}stopHubConnection(){this.hubConnection&&(this.messageThreadSource.next([]),this.hubConnection.stop())}getMessageThread(t){return this.http.get(this.baseUrl+"messages/thread/"+t)}sendMessage(t,o){var c=this;return(0,P.Z)(function*(){return c.hubConnection?.invoke("SendMessage",{recipientUsername:t,content:o}).catch(a=>console.log(a))})()}deleteMessage(t){return this.http.delete(this.baseUrl+"messages/"+t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(O.eN),e.LFG(E.z))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var L=i(3238);const q=["messageForm"],z=function(s,r){return{"justify-content-start":s,"justify-content-end":r}},B=function(s,r){return{"bg-white":s,"bg-success":r}};function H(s,r){if(1&s&&(e.TgZ(0,"div")(1,"div",18)(2,"div",14)(3,"div",19)(4,"div"),e._uU(5),e.qZA(),e.TgZ(6,"div",20)(7,"span",21),e._uU(8),e.ALo(9,"date"),e.qZA()()()()()()),2&s){const t=r.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(7,z,t.recipientUsername!==o.recipientEmail,t.recipientUsername===o.recipientEmail)),e.xp6(2),e.Q6J("ngClass",e.WLB(10,B,t.recipientUsername!==o.recipientEmail,t.recipientUsername===o.recipientEmail)),e.xp6(2),e.hij(" ",t.content," "),e.xp6(3),e.hij(" ",e.xi3(9,4,t.messageSent,"shortTime")," ")}}function G(s,r){1&s&&e._UZ(0,"i",22)}function R(s,r){1&s&&e._UZ(0,"i",23)}function j(s,r){if(1&s){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3),e._UZ(3,"img",4),e.TgZ(4,"span",5),e._uU(5),e.qZA()()(),e.TgZ(6,"div",6),e.YNc(7,H,10,13,"div",7),e.ALo(8,"async"),e.qZA(),e.TgZ(9,"div",8)(10,"form",9,10),e.NdJ("ngSubmit",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.sendMessage())}),e.TgZ(12,"div",11)(13,"div",12)(14,"input",13),e.NdJ("ngModelChange",function(c){e.CHM(t);const a=e.oxw();return e.KtG(a.messageContent=c)}),e.qZA()(),e.TgZ(15,"div",14)(16,"button",15),e.YNc(17,G,1,0,"i",16),e.YNc(18,R,1,0,"i",17),e.qZA()()()()()()}if(2&s){const t=e.MAs(11),o=e.oxw();e.xp6(3),e.s9C("src",o.recipient.photoUrl,e.LSH),e.xp6(2),e.hij(" ",o.recipient.fullName," "),e.xp6(2),e.Q6J("ngForOf",e.lcZ(8,7,o.messageService.messageThread$)),e.xp6(7),e.Q6J("ngModel",o.messageContent),e.xp6(2),e.Q6J("disabled",!t.valid||o.loading),e.xp6(1),e.Q6J("ngIf",!o.loading),e.xp6(1),e.Q6J("ngIf",o.loading)}}const X=[{path:"summary",component:T},{path:"edit",component:w,data:{breadcrumb:{alias:"editProfileTitle"}}},{path:"products",component:I,loadChildren:()=>Promise.all([i.e(592),i.e(680)]).then(i.bind(i,6680)).then(s=>s.AccountProductsModule)},{path:"services",component:J,loadChildren:()=>Promise.all([i.e(592),i.e(734)]).then(i.bind(i,4734)).then(s=>s.ServicesModule)},{path:"messages/:username",component:(()=>{class s{constructor(t,o,c,a,u){this.messageService=t,this.route=o,this.presenceService=c,this.bcService=a,this.userService=u,this.messageContent="",this.loading=!1;const h=localStorage.getItem("account");this.account=JSON.parse(h),this.recipientEmail=this.route.snapshot.paramMap.get("username")}ngOnInit(){this.messageService.createHubConnection(this.account,this.recipientEmail),this.loadRecipient()}loadRecipient(){console.log(this.recipientEmail),this.userService.getUserByEmail(this.recipientEmail).subscribe({next:t=>this.recipient=t})}ngOnDestroy(){this.messageService.stopHubConnection()}sendMessage(){this.recipientEmail&&(this.loading=!0,this.messageService.sendMessage(this.recipientEmail,this.messageContent).then(()=>{this.messageForm?.reset()}).finally(()=>this.loading=!1))}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(k),e.Y36(l.gz),e.Y36(L.Q),e.Y36(p.pm),e.Y36(C.K))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-messages"]],viewQuery:function(t,o){if(1&t&&e.Gf(q,5),2&t){let c;e.iGM(c=e.CRH())&&(o.messageForm=c.first)}},decls:1,vars:1,consts:[["class","card shadow-sm rounded-4",4,"ngIf"],[1,"card","shadow-sm","rounded-4"],[1,"card-header"],[1,"d-flex","align-items-center"],[1,"img-fluid","rounded-circle","me-3",3,"src"],[1,"fs-3","fw-semibold"],[1,"card-body","bg-dark","bg-opacity-10","overflow-scroll","mh-50"],[4,"ngFor","ngForOf"],[1,"card-footer"],["autocomplete","off",3,"ngSubmit"],["messageForm","ngForm"],[1,"row","d-flex","justify-content-between"],[1,"col"],["name","messageContent","required","","type","text","placeholder","Send a private message",1,"form-control","form-control-info","input-sm","rounded-pill",3,"ngModel","ngModelChange"],[1,"col-auto"],["type","submit",1,"btn","btn-info","rounded-circle",3,"disabled"],["class","fa fa-send",4,"ngIf"],["class","fa fa-spinner fa-spin",4,"ngIf"],[1,"row","d-flex",3,"ngClass"],[1,"px-3","py-2","mb-2","rounded-4","shadow-sm",3,"ngClass"],[1,"text-end","text-muted"],[2,"font-size","12px"],[1,"fa","fa-send"],[1,"fa","fa-spinner","fa-spin"]],template:function(t,o){1&t&&e.YNc(0,j,19,9,"div",0),2&t&&e.Q6J("ngIf",o.recipient)},dependencies:[d.mk,d.sg,d.O5,n._Y,n.Fj,n.JJ,n.JL,n.Q7,n.On,n.F,d.Ov,d.uU],styles:["img[_ngcontent-%COMP%]{max-width:60px}.bg-success[_ngcontent-%COMP%]{background-color:#dcfbc5!important}.card-body[_ngcontent-%COMP%]{max-height:60vh!important;overflow-x:hidden!important}*[_ngcontent-%COMP%]{scrollbar-width:auto;scrollbar-color:#969696 #ffffff}*[_ngcontent-%COMP%]::-webkit-scrollbar{width:16px}*[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#969696;border-radius:10px;border:3px solid white}"]}),s})(),loadChildren:()=>i.e(95).then(i.bind(i,2095)).then(s=>s.MessagesModule)},{path:"saved-profiles",component:M},{path:"change-password",component:y,data:{breadcrumb:{alias:"changePassword"}}}];let D=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[l.Bz.forChild(X),l.Bz]}),s})();var $=i(4466);let V=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[d.ez,D,$.m,n.u5]}),s})()}}]);