"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[377],{1377:(N,f,n)=>{n.r(f),n.d(f,{AccountProductDetailModule:()=>w});var a=n(6895),u=n(2559),i=n(433),l=n(435),t=n(1571),g=n(5528),v=n(8909),y=n(7185),m=n(2262),x=n(4015),A=n(2699),C=n(4217);function P(e,c){if(1&e&&(t.TgZ(0,"option",21),t.ALo(1,"number"),t._uU(2),t.qZA()),2&e){const o=c.$implicit;t.s9C("value",t.lcZ(1,2,o.id)),t.xp6(2),t.hij(" ",o.name," ")}}function Z(e,c){if(1&e&&(t.TgZ(0,"div",17)(1,"select",18),t.YNc(2,P,3,4,"option",19),t.qZA(),t.TgZ(3,"label",20),t._uU(4,"Product type"),t.qZA()()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("formControl",o.productForm.controls.productItemClass.get("itemClassId")),t.xp6(1),t.Q6J("ngForOf",o.types)}}function I(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"form",9),t.NdJ("ngSubmit",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.onSubmit())}),t._UZ(1,"app-text-input",10)(2,"app-text-area",10),t.TgZ(3,"div",4)(4,"div",11),t._UZ(5,"app-text-input",12),t.qZA(),t.TgZ(6,"div",11),t._UZ(7,"app-text-input",12),t.qZA()(),t.YNc(8,Z,5,2,"div",13),t.TgZ(9,"div",4)(10,"div",14)(11,"button",15),t._uU(12,"Confirm changes "),t._UZ(13,"i",16),t.qZA()()()()}if(2&e){const o=t.oxw();t.Q6J("formGroup",o.productForm),t.xp6(1),t.Q6J("label","Name")("formControl",o.productForm.controls.name),t.xp6(1),t.Q6J("label","Description")("formControl",o.productForm.controls.description),t.xp6(3),t.Q6J("label","Price")("type","number")("formControl",o.productForm.controls.price),t.xp6(2),t.Q6J("label","Quantity")("type","number")("formControl",o.productForm.controls.stockQuantity),t.xp6(1),t.Q6J("ngIf",o.productForm.get("productItemClass")),t.xp6(3),t.Q6J("disabled",o.productForm.invalid||!o.productForm.dirty)}}let S=(()=>{class e{constructor(o,r,s,d,p,h,M){this.productService=o,this.fb=r,this.route=s,this.bcService=d,this.toastr=p,this.router=h,this.confirmService=M,this.productForm=new i.cw({}),this.types=[],this.product={},this.photos=[],this.modal=new l.u,this.id=Number(this.route.snapshot.paramMap.get("id"))}ngOnInit(){this.loadTypes()}loadProduct(){this.productService.getProduct(this.id).subscribe({next:o=>{this.product=o,this.bcService.set("@productName",o.name),this.bcService.set("@editTitle","Edit "+o.name),this.initForm(this.product),this.product.productPhotos.forEach(r=>{this.photos.push(r.photo)})}})}loadTypes(){this.productService.getTypes().subscribe({next:o=>{this.types=o},complete:()=>{this.loadProduct()}})}onSubmit(){this.modal.title=`Save changes for ${this.product.name}`,this.modal.message=`Do you want to confirm changes made to your product ${this.product.name}`;const o=this.productForm.value;this.confirmService.confirm(this.modal).subscribe({next:r=>{r&&this.productService.edit(o).subscribe({next:()=>{this.productForm.reset(o),this.toastr.success("Product updated successfully"),this.router.navigateByUrl("/account/products/list/"+this.product.id)}})}})}initForm(o){this.productForm=this.fb.group({id:[""],name:["",[i.kI.required,i.kI.minLength(10),i.kI.maxLength(100)]],description:["",[i.kI.required,i.kI.minLength(10),i.kI.maxLength(300)]],price:["",[i.kI.required]],stockQuantity:["",[i.kI.required]],productItemClass:this.fb.group({itemClassId:[o.productItemClass.itemClassId,[i.kI.required]]})}),this.productForm.patchValue(this.product)}receive(o){this.product=o}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(g.M),t.Y36(i.qu),t.Y36(u.gz),t.Y36(v.pm),t.Y36(y._W),t.Y36(u.F0),t.Y36(m.z))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-product-edit"]],decls:10,vars:5,consts:[[1,"container-fluid","container-md"],[1,"mb-4"],[1,"text-decoration-none",3,"routerLink"],[1,"fa","fa-angle-left","me-2"],[1,"row"],[1,"col-12","col-sm-10","col-md-6","col-lg-4"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"col-12","col-md-6","col-lg-8"],[3,"object","photos","controller","send"],[3,"formGroup","ngSubmit"],[3,"label","formControl"],[1,"col-6"],[3,"label","type","formControl"],["class","form-floating","id","floatingSelect",4,"ngIf"],[1,"col","d-flex"],["type","submit",1,"btn","btn-success","my-3",3,"disabled"],[1,"fa","fa-floppy-o","ms-2"],["id","floatingSelect",1,"form-floating"],[1,"form-select",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["for","floatingSelect"],[3,"value"]],template:function(o,r){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"a",2),t._UZ(3,"i",3),t._uU(4," Back "),t.qZA()(),t.TgZ(5,"div",4)(6,"div",5),t.YNc(7,I,14,13,"form",6),t.qZA(),t.TgZ(8,"div",7)(9,"app-photo-upload",8),t.NdJ("send",function(d){return r.receive(d)}),t.qZA()()()()),2&o&&(t.xp6(2),t.MGl("routerLink","/account/products/list/",r.product.id,""),t.xp6(5),t.Q6J("ngIf",r.types&&r.productForm),t.xp6(2),t.Q6J("object",r.product)("photos",r.photos)("controller","products"))},dependencies:[a.sg,a.O5,x.t,i._Y,i.YN,i.Kr,i.EJ,i.JJ,i.JL,i.oH,i.sg,A.N,C.U,u.rH,a.JJ]}),e})();var b=n(9105),F=n(3968);function T(e,c){if(1&e&&(t.TgZ(0,"div",16),t._UZ(1,"ngx-gallery",17),t.qZA()),2&e){const o=t.oxw(2);t.xp6(1),t.Q6J("options",o.galleryOptions)("images",o.galleryImages)}}function J(e,c){if(1&e){const o=t.EpF();t.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"a",5),t._UZ(6,"i",6),t._uU(7," Back "),t.qZA()(),t._UZ(8,"app-detail",7),t.qZA(),t.TgZ(9,"div",8),t.YNc(10,T,2,2,"div",9),t.qZA()(),t.TgZ(11,"div",10)(12,"div",11)(13,"a",12),t._UZ(14,"i",13),t._uU(15," Edit"),t.qZA(),t.TgZ(16,"button",14),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.delete())}),t._UZ(17,"i",15),t._uU(18," Delete"),t.qZA()()()()()}if(2&e){const o=t.oxw();t.xp6(8),t.Q6J("item",o.product)("fromAccount",!0),t.xp6(2),t.Q6J("ngIf",o.showGallery())}}let U=(()=>{class e{constructor(o,r,s,d,p,h){this.route=o,this.bcService=r,this.productService=s,this.router=d,this.toastr=p,this.confirmService=h,this.product={},this.galleryOptions=[],this.galleryImages=[],this.modal=new l.u,this.id=Number(this.route.snapshot.paramMap.get("id")),this.galleryOptions=[{imagePercent:100,thumbnailsColumns:4,imageAnimation:b.zw.Slide,preview:!0,imageSwipe:!0,thumbnailsSwipe:!0,previewCloseOnClick:!0,previewCloseOnEsc:!0,thumbnailMargin:0,thumbnailsMargin:0,previewKeyboardNavigation:!0}]}ngOnInit(){this.loadProduct()}loadProduct(){this.productService.getProduct(this.id).subscribe({next:o=>{this.product=o,this.bcService.set("@productName",o.name),this.galleryImages=this.defineGalleryImages()}})}delete(){this.modal.title=`Delete ${this.product.name}`,this.modal.message=`Are you sure to delete the product '${this.product.name}'?`,this.modal.btnOkText="Delete",this.confirmService.confirm(this.modal).subscribe({next:o=>{o&&this.productService.delete(this.id).subscribe({next:()=>{this.router.navigateByUrl("/account/products/list"),this.toastr.success("Product deleted successfully")}})}})}defineGalleryImages(){if(0===this.product.productPhotos.length)return[];const o=[],r=[];this.product.productPhotos.forEach(s=>{r.push(s.photo)});for(const s of r)o.push({small:s.url,medium:s.url,big:s.url});return o}showGallery(){return this.galleryImages.length>0}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(u.gz),t.Y36(v.pm),t.Y36(g.M),t.Y36(u.F0),t.Y36(y._W),t.Y36(m.z))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-account-product-detail"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"container-fluid","container-md"],[1,"row","mb-3"],[1,"col-12","col-lg-6","col-xl-7","mb-3"],[1,"mb-4"],["routerLink","/account/products/list",1,"text-decoration-none"],[1,"fa","fa-angle-left","me-2"],[3,"item","fromAccount"],[1,"col-12","col-lg-6","col-xl-5"],["class","gallery-viewer",4,"ngIf"],[1,"row"],[1,"col","d-flex","justify-content-end"],["routerLink","edit",1,"btn","btn-outline-info","me-2"],[1,"fa","fa-pencil","me-2"],[1,"btn","btn-outline-danger","me-2",3,"click"],[1,"fa","fa-trash","me-2"],[1,"gallery-viewer"],[1,"ngx-gallery",3,"options","images"]],template:function(o,r){1&o&&t.YNc(0,J,19,3,"div",0),2&o&&t.Q6J("ngIf",r.product)},dependencies:[a.O5,b.g$,F.J,u.rH]}),e})();var D=n(9646);const Y=[{path:"",component:U},{path:"edit",component:S,data:{breadcrumb:{alias:"editTitle"}},canDeactivate:[(()=>{class e{constructor(o){this.confirmService=o,this.modal=new l.u,this.modal.title="Product edit",this.modal.message="Are you sure to lose changes made to this product?"}canDeactivate(o){return o.productForm?.dirty?this.confirmService.confirm(this.modal):(0,D.of)(!0)}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(m.z))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})()]}];let Q=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.Bz.forChild(Y),u.Bz]}),e})();var E=n(4466);let w=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[a.ez,E.m,Q]}),e})()}}]);