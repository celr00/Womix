"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[226],{1226:(B,p,n)=>{n.r(p),n.d(p,{ItemModule:()=>M});var m=n(6895),a=n(2559),f=n(9105),d=n(435),e=n(1571),g=n(8909),x=n(6325),y=n(7185),v=n(2262),b=n(3968);function C(i,r){if(1&i&&(e.TgZ(0,"div",16),e._UZ(1,"ngx-gallery",17),e.qZA()),2&i){const t=e.oxw(2);e.xp6(1),e.Q6J("options",t.galleryOptions)("images",t.galleryImages)}}function I(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"a",5),e._UZ(6,"i",6),e._uU(7," Back "),e.qZA()(),e._UZ(8,"app-detail",7),e.qZA(),e.TgZ(9,"div",8),e.YNc(10,C,2,2,"div",9),e.qZA()(),e.TgZ(11,"div",10)(12,"div",11)(13,"a",12),e._UZ(14,"i",13),e._uU(15," Edit"),e.qZA(),e.TgZ(16,"button",14),e.NdJ("click",function(){e.CHM(t);const c=e.oxw();return e.KtG(c.delete())}),e._UZ(17,"i",15),e._uU(18," Delete"),e.qZA()()()()()}if(2&i){const t=e.oxw();e.xp6(8),e.Q6J("item",t.service)("fromAccount",!0)("type","service"),e.xp6(2),e.Q6J("ngIf",t.showGallery())}}let S=(()=>{class i{constructor(t,o,c,l,u,h){this.route=t,this.bcService=o,this.serviceService=c,this.router=l,this.toastr=u,this.confirmService=h,this.service={},this.galleryOptions=[],this.galleryImages=[],this.modal=new d.u,this.id=Number(this.route.snapshot.paramMap.get("id")),this.galleryOptions=[{imagePercent:100,thumbnailsColumns:4,imageAnimation:f.zw.Slide,preview:!0,imageSwipe:!0,thumbnailsSwipe:!0,previewCloseOnClick:!0,previewCloseOnEsc:!0,thumbnailMargin:0,thumbnailsMargin:0,previewKeyboardNavigation:!0}]}ngOnInit(){this.loadService()}loadService(){this.serviceService.getById(this.id).subscribe({next:t=>{this.service=t,this.bcService.set("@serviceNameTitle",t.name),this.galleryImages=this.defineGalleryImages()}})}delete(){this.modal.title=`Delete ${this.service.name}`,this.modal.message=`Are you sure to delete the service '${this.service.name}'?`,this.modal.btnOkText="Delete",this.confirmService.confirm(this.modal).subscribe({next:t=>{t&&this.serviceService.delete(this.id).subscribe({next:()=>{this.router.navigateByUrl("/account/services/list"),this.toastr.success("Service deleted successfully")}})}})}defineGalleryImages(){if(0===this.service.servicePhotos.length)return[];const t=[],o=[];this.service.servicePhotos.forEach(c=>{o.push(c.photo)});for(const c of o)t.push({small:c.url,medium:c.url,big:c.url});return t}showGallery(){return this.galleryImages.length>0}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(a.gz),e.Y36(g.pm),e.Y36(x.r),e.Y36(a.F0),e.Y36(y._W),e.Y36(v.z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-item"]],decls:1,vars:1,consts:[[4,"ngIf"],[1,"container-fluid","container-md"],[1,"row","mb-3"],[1,"col-12","col-lg-6","col-xl-7","mb-3"],[1,"mb-4"],["routerLink","/account/services/list",1,"text-decoration-none"],[1,"fa","fa-angle-left","me-2"],[3,"item","fromAccount","type"],[1,"col-12","col-lg-6","col-xl-5"],["class","gallery-viewer",4,"ngIf"],[1,"row"],[1,"col","d-flex","justify-content-end"],["routerLink","edit",1,"btn","btn-outline-info","me-2"],[1,"fa","fa-pencil","me-2"],[1,"btn","btn-outline-danger","me-2",3,"click"],[1,"fa","fa-trash","me-2"],[1,"gallery-viewer"],[1,"ngx-gallery",3,"options","images"]],template:function(t,o){1&t&&e.YNc(0,I,19,4,"div",0),2&t&&e.Q6J("ngIf",o.service)},dependencies:[m.O5,a.rH,f.g$,b.J]}),i})();var s=n(433),Z=n(4015),F=n(2699),J=n(4217);function T(i,r){if(1&i&&(e.TgZ(0,"option",21),e.ALo(1,"number"),e._uU(2),e.qZA()),2&i){const t=r.$implicit;e.s9C("value",e.lcZ(1,2,t.id)),e.xp6(2),e.hij(" ",t.name," ")}}function _(i,r){if(1&i&&(e.TgZ(0,"div",17)(1,"select",18),e.YNc(2,T,3,4,"option",19),e.qZA(),e.TgZ(3,"label",20),e._uU(4,"Service category"),e.qZA()()),2&i){const t=e.oxw(3);e.xp6(1),e.Q6J("formControl",t.serviceForm.controls.serviceCategory.get("categoryId")),e.xp6(1),e.Q6J("ngForOf",t.categories)}}function E(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"form",10),e.NdJ("ngSubmit",function(){e.CHM(t);const c=e.oxw(2);return e.KtG(c.onSubmit())}),e._UZ(1,"app-text-input",11)(2,"app-text-area",11)(3,"app-text-input",12),e.YNc(4,_,5,2,"div",13),e.TgZ(5,"div",5)(6,"div",14)(7,"button",15),e._uU(8,"Confirm changes "),e._UZ(9,"i",16),e.qZA()()()()}if(2&i){const t=e.oxw(2);e.Q6J("formGroup",t.serviceForm),e.xp6(1),e.Q6J("label","Name")("formControl",t.serviceForm.controls.name),e.xp6(1),e.Q6J("label","Description")("formControl",t.serviceForm.controls.description),e.xp6(1),e.Q6J("label","Price")("type","number")("formControl",t.serviceForm.controls.price),e.xp6(1),e.Q6J("ngIf",t.serviceForm.get("serviceCategory")),e.xp6(3),e.Q6J("disabled",t.serviceForm.invalid||!t.serviceForm.dirty)}}function U(i,r){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"a",3),e._UZ(3,"i",4),e._uU(4," Back "),e.qZA()(),e.TgZ(5,"div",5)(6,"div",6),e.YNc(7,E,10,10,"form",7),e.qZA(),e.TgZ(8,"div",8)(9,"app-photo-upload",9),e.NdJ("send",function(c){e.CHM(t);const l=e.oxw();return e.KtG(l.receive(c))}),e.qZA()()()()}if(2&i){const t=e.oxw();e.xp6(2),e.MGl("routerLink","/account/services/list/",t.service.id,""),e.xp6(5),e.Q6J("ngIf",t.categories&&t.serviceForm),e.xp6(2),e.Q6J("object",t.service)("photos",t.photos)("controller","services")}}let Y=(()=>{class i{unloadNotification(t){this.serviceForm?.dirty&&(t.returnValue=!0)}constructor(t,o,c,l,u,h,Q){this.serviceService=t,this.fb=o,this.route=c,this.bcService=l,this.toastr=u,this.router=h,this.confirmService=Q,this.serviceForm=new s.cw({}),this.service={},this.photos=[],this.modal=new d.u,this.id=Number(this.route.snapshot.paramMap.get("id"))}ngOnInit(){this.loadCategories()}loadService(){this.serviceService.getById(this.id).subscribe({next:t=>{this.service=t,this.bcService.set("@serviceNameTitle",t.name),this.bcService.set("@serviceEditTitle","Edit "+t.name),this.initForm(this.service),this.service.servicePhotos.forEach(o=>{this.photos.push(o.photo)}),this.modal.title=`Service ${this.service.name}`,this.modal.message=`Do you confirm changes made to the service '${this.service.name}'?`}})}loadCategories(){this.serviceService.getCategories().subscribe({next:t=>{this.categories=t},complete:()=>{this.loadService()}})}onSubmit(){this.modal.title=`Save changes for ${this.service.name}`,this.modal.message=`Do you want to confirm changes made to your service ${this.service.name}`;const t=this.serviceForm.value;this.confirmService.confirm(this.modal).subscribe({next:o=>{o&&this.serviceService.edit(t).subscribe({next:()=>{this.serviceForm.reset(t),this.toastr.success("Service updated successfully"),this.router.navigateByUrl("/account/services/list/"+this.id)}})}})}initForm(t){this.serviceForm=this.fb.group({id:[""],name:["",[s.kI.required,s.kI.minLength(10),s.kI.maxLength(100)]],description:["",[s.kI.required,s.kI.minLength(10),s.kI.maxLength(300)]],price:["",[s.kI.required]],serviceCategory:this.fb.group({categoryId:[t.serviceCategory.categoryId,[s.kI.required]]})}),this.serviceForm.patchValue(t)}receive(t){this.service=t}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(x.r),e.Y36(s.qu),e.Y36(a.gz),e.Y36(g.pm),e.Y36(y._W),e.Y36(a.F0),e.Y36(v.z))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-edit"]],hostBindings:function(t,o){1&t&&e.NdJ("beforeunload",function(l){return o.unloadNotification(l)},!1,e.Jf7)},decls:1,vars:1,consts:[["class","container-fluid container-md",4,"ngIf"],[1,"container-fluid","container-md"],[1,"mb-4"],[1,"text-decoration-none",3,"routerLink"],[1,"fa","fa-angle-left","me-2"],[1,"row"],[1,"col-12","col-sm-10","col-md-6","col-lg-4"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"col-12","col-md-6","col-lg-8"],[3,"object","photos","controller","send"],[3,"formGroup","ngSubmit"],[3,"label","formControl"],[3,"label","type","formControl"],["class","form-floating","id","floatingSelect",4,"ngIf"],[1,"col","d-flex"],["type","submit",1,"btn","btn-success","my-3",3,"disabled"],[1,"fa","fa-floppy-o","ms-2"],["id","floatingSelect",1,"form-floating"],[1,"form-select",3,"formControl"],[3,"value",4,"ngFor","ngForOf"],["for","floatingSelect"],[3,"value"]],template:function(t,o){1&t&&e.YNc(0,U,10,5,"div",0),2&t&&e.Q6J("ngIf",o.service&&o.categories)},dependencies:[m.sg,m.O5,a.rH,Z.t,s._Y,s.YN,s.Kr,s.EJ,s.JJ,s.JL,s.oH,s.sg,F.N,J.U,m.JJ]}),i})();var A=n(9646);const N=[{path:"",component:S},{path:"edit",component:Y,data:{breadcrumb:{alias:"serviceEditTitle"}},canDeactivate:[(()=>{class i{constructor(t){this.confirmService=t,this.modal=new d.u,this.modal.title="Service edit",this.modal.message="Are you sure to lose changes made to this service?"}canDeactivate(t){return t.serviceForm?.dirty?this.confirmService.confirm(this.modal):(0,A.of)(!0)}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(v.z))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})()]}];let w=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[a.Bz.forChild(N),a.Bz]}),i})();var G=n(4466);let M=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[m.ez,w,G.m]}),i})()}}]);