"use strict";(self.webpackChunkclient=self.webpackChunkclient||[]).push([[30],{30:(B,S,r)=>{r.r(S),r.d(S,{AccountModule:()=>de});var o=r(6895),h=r(2559),a=r(433),C=r(435),e=r(1571),A=r(5329),U=r(8909),Z=r(7185),f=r(2262),T=r(4015),M=r(4897),J=r(2699),P=r(9241);function I(s,i){if(1&s&&(e.TgZ(0,"div",5)(1,"h3"),e._uU(2,"Address"),e.qZA(),e.TgZ(3,"div",16),e._UZ(4,"app-text-input",7),e.qZA(),e.TgZ(5,"div",17),e._UZ(6,"app-text-input",7),e.qZA(),e.TgZ(7,"div",18),e._UZ(8,"app-text-input",7),e.qZA(),e.TgZ(9,"div",19),e._UZ(10,"app-text-input",7),e.qZA(),e.TgZ(11,"div",20),e._UZ(12,"app-text-input",7),e.qZA()()),2&s){const t=e.oxw(2);e.xp6(4),e.Q6J("label","Number")("formControl",t.userForm.controls.appUserAddress.get("address").get("number")),e.xp6(2),e.Q6J("label","Street")("formControl",t.userForm.controls.appUserAddress.get("address").get("street")),e.xp6(2),e.Q6J("label","City")("formControl",t.userForm.controls.appUserAddress.get("address").get("city")),e.xp6(2),e.Q6J("label","State")("formControl",t.userForm.controls.appUserAddress.get("address").get("state")),e.xp6(2),e.Q6J("label","Zipcode")("formControl",t.userForm.controls.appUserAddress.get("address").get("zipcode"))}}function O(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tabset",1)(1,"tab",2)(2,"form",3),e.NdJ("ngSubmit",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.onSubmit())}),e.TgZ(3,"div",4)(4,"div",5)(5,"div",6),e._UZ(6,"app-text-input",7),e.qZA(),e.TgZ(7,"div",6),e._UZ(8,"app-text-input",7),e.qZA(),e.TgZ(9,"div",8),e._UZ(10,"app-date-picker",7),e.qZA(),e.TgZ(11,"div",8),e._UZ(12,"app-text-input",7),e.qZA()(),e.TgZ(13,"div",5)(14,"h3"),e._uU(15,"Social media"),e.qZA(),e.TgZ(16,"div",9),e._UZ(17,"app-text-input",7),e.qZA(),e.TgZ(18,"div",9),e._UZ(19,"app-text-input",7),e.qZA()(),e.YNc(20,I,13,10,"div",10),e.TgZ(21,"button",11),e._uU(22,"Save changes "),e._UZ(23,"i",12),e.qZA()()()(),e.TgZ(24,"tab",13),e._UZ(25,"app-photo-upload",14),e.qZA(),e._UZ(26,"tab",15),e.qZA()}if(2&s){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.userForm),e.xp6(4),e.Q6J("label","First name")("formControl",t.userForm.controls.firstName),e.xp6(2),e.Q6J("label","Last name")("formControl",t.userForm.controls.lastName),e.xp6(2),e.Q6J("label","Birth date")("formControl",t.userForm.controls.dateOfBirth),e.xp6(2),e.Q6J("label","Phone number")("formControl",t.userForm.controls.phoneNumber),e.xp6(5),e.Q6J("label","Facebook")("formControl",t.userForm.controls.facebook),e.xp6(2),e.Q6J("label","Instagram")("formControl",t.userForm.controls.instagram),e.xp6(1),e.Q6J("ngIf",t.userForm.controls.appUserAddress.get("address")),e.xp6(1),e.Q6J("disabled",!t.userForm.dirty||t.userForm.invalid),e.xp6(4),e.Q6J("photos",t.photo)("controller","account")("userId",t.user.id)}}let N=(()=>{class s{unloadNotification(t){this.userForm?.dirty&&(t.returnValue=!0)}constructor(t,n,l,d,b,E,Q){this.accountService=t,this.fb=n,this.route=l,this.bcService=d,this.toastr=b,this.router=E,this.confirmService=Q,this.userForm=new a.cw({}),this.user={},this.maxDate=new Date,this.modal=new C.u,this.photo=[],this.bcService.set("@editProfileTitle","Edit Profile")}ngOnInit(){this.loadUser(),this.maxDate.setFullYear(this.maxDate.getFullYear()-18)}onSubmit(){this.modal.title=`${this.user.firstName} ${this.user.lastName} profile information`,this.modal.message="Do you confirm changes made to your account information?",null===this.user.appUserAddress&&(this.userForm.controls.appUserAddress.get("userId")?.setValue(0),this.userForm.controls.appUserAddress.get("addressId")?.setValue(0),this.userForm.controls.appUserAddress.get("address")?.get("id")?.setValue(0)),null===this.user.appUserPhoto&&(this.userForm.controls.appUserPhoto.get("userId")?.setValue(0),this.userForm.controls.appUserPhoto.get("photoId")?.setValue(0),this.userForm.controls.appUserPhoto.get("photo")?.get("id")?.setValue(0)),this.userForm.controls.dateOfBirth.setValue(this.getDateOnly(this.userForm.controls.dateOfBirth.value));const n=this.userForm.value;this.confirmService.confirm(this.modal).subscribe({next:l=>{l&&this.accountService.update(n).subscribe({next:d=>{this.user=d,this.userForm.reset(),this.userForm.patchValue(d),this.toastr.success("User updated successfully")}})}})}loadUser(){this.accountService.getUserEntity().subscribe({next:t=>{this.user=t,""===this.user.appUserPhoto.photo.url?this.photo=[]:this.photo.push(t.appUserPhoto.photo)},complete:()=>{const t=new Date(this.user.dateOfBirth);this.initForm(t)}})}initForm(t){this.userForm=this.fb.group({firstName:["",[a.kI.required]],lastName:["",[a.kI.required]],dateOfBirth:[t,[a.kI.required]],facebook:["",[a.kI.required]],instagram:["",[a.kI.required]],phoneNumber:["",[a.kI.required]],appUserPhoto:this.fb.group({userId:[""],photoId:[""],photo:this.fb.group({url:[""],id:[""]})}),appUserAddress:this.fb.group({userId:[""],addressId:[""],address:this.fb.group({number:["",[a.kI.required]],street:["",[a.kI.required]],city:["",[a.kI.required]],state:["",[a.kI.required]],zipcode:["",[a.kI.required]],id:[""]})})}),this.userForm.patchValue(this.user)}getDateOnly(t){if(!t)return;let n=new Date(t);return new Date(n.setMinutes(n.getMinutes()-n.getTimezoneOffset())).toISOString().slice(0,10)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(A.B),e.Y36(a.qu),e.Y36(h.gz),e.Y36(U.pm),e.Y36(Z._W),e.Y36(h.F0),e.Y36(f.z))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-edit"]],hostBindings:function(t,n){1&t&&e.NdJ("beforeunload",function(d){return n.unloadNotification(d)},!1,e.Jf7)},decls:1,vars:1,consts:[["class","member-tabset",4,"ngIf"],[1,"member-tabset"],["heading","Information",1,"pt-3"],[1,"mb-4",3,"formGroup","ngSubmit"],[1,"container-fluid","container-md"],[1,"row"],[1,"col-12","col-sm-6","col-md-4","col-lg-4"],[3,"label","formControl"],[1,"col-12","col-sm-6","col-md-4","col-lg-3"],[1,"col-12","col-sm-6","col-md-5","col-lg-4"],["class","row",4,"ngIf"],["type","submit",1,"btn","btn-success",3,"disabled"],[1,"fa","fa-floppy-o","ms-2"],["heading","Photo",1,"pt-3"],[3,"photos","controller","userId"],["heading","Curriculum",1,"pt-3"],[1,"col-4","col-sm-3","col-md-3","col-lg-2"],[1,"col-8","col-sm-9","col-md-4","col-lg-3"],[1,"col-12","col-sm-7","col-md-5","col-lg-4"],[1,"col-8","col-sm-5","col-md-4","col-lg-3"],[1,"col-4","col-sm-4","col-md-3","col-lg-2"]],template:function(t,n){1&t&&e.YNc(0,O,27,18,"tabset",0),2&t&&e.Q6J("ngIf",n.user)},dependencies:[o.O5,T.t,M.L,a._Y,a.JJ,a.JL,a.oH,a.sg,J.N,P.wW,P.AH]}),s})();var p=r(3238),g=r(1106);let c=(()=>{class s{constructor(t,n){this.accountService=t,this.presenceService=n,this.user={},this.onlineUsers=[],this.account={};const l=localStorage.getItem("account");this.account=JSON.parse(l)}ngOnInit(){this.loadUser(),this.loadOnlineUsers()}loadUser(){this.accountService.getUser().subscribe({next:t=>{this.user=t}})}loadOnlineUsers(){this.presenceService.onlineUsers$.subscribe({next:t=>{this.onlineUsers=t}})}togglePresence(){this.onlineUsers.includes(this.user.userName)?(this.presenceService.stopHubConnection(),this.onlineUsers=this.onlineUsers.filter(t=>t!==this.user.email)):this.presenceService.createHubConnection(this.account)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(A.B),e.Y36(p.Q))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-home"]],decls:6,vars:5,consts:[[3,"user","fromAccount"],[1,"form-check","form-switch"],["type","checkbox","role","switch","id","flexSwitchCheckDefault",1,"form-check-input",3,"checked","click"],["for","flexSwitchCheckDefault",1,"form-check-label"]],template:function(t,n){if(1&t&&(e._UZ(0,"app-user-card",0),e.TgZ(1,"div",1)(2,"input",2),e.NdJ("click",function(){return n.togglePresence()}),e.ALo(3,"async"),e.qZA(),e.TgZ(4,"label",3),e._uU(5,"Appear online"),e.qZA()()),2&t){let l;e.Q6J("user",n.user)("fromAccount",!0),e.xp6(2),e.Q6J("checked",null==(l=e.lcZ(3,3,n.presenceService.onlineUsers$))?null:l.includes(n.user.userName))}},dependencies:[g.r,o.Ov]}),s})(),u=(()=>{class s{unloadNotification(t){this.passwordForm?.touched&&(t.returnValue=!0)}constructor(t,n,l,d){this.bcService=t,this.fb=n,this.accountService=l,this.toastr=d,this.passwordForm=new a.cw({}),this.complexPassword="(?=^.{6,255}$)((?=.*d)(?=.*[A-Z])(?=.*[a-z])|(?=.*d)(?=.*[^A-Za-z0-9])(?=.*[a-z])|(?=.*[^A-Za-z0-9])(?=.*[A-Z])(?=.*[a-z])|(?=.*d)(?=.*[A-Z])(?=.*[^A-Za-z0-9]))^.*",this.bcService.set("@changePassword","Change password")}ngOnInit(){this.initForm()}initForm(){this.passwordForm=this.fb.group({currentPassword:["",[a.kI.required,a.kI.minLength(8),a.kI.maxLength(60)]],newPassword:["",[a.kI.required,a.kI.minLength(8),a.kI.maxLength(60),a.kI.pattern(this.complexPassword)]],repeatNewPassword:["",[a.kI.required,a.kI.minLength(8),a.kI.maxLength(60),this.matchValues("newPassword")]]}),this.passwordForm.controls.newPassword.valueChanges.subscribe({next:()=>this.passwordForm.controls.repeatNewPassword.updateValueAndValidity()})}matchValues(t){return n=>n.value===n.parent?.get(t)?.value?null:{notMatching:!0}}onSubmit(){this.accountService.resetPassword(this.passwordForm.value).subscribe({next:()=>{this.toastr.success("Password changed successfully"),this.passwordForm.reset()},error:()=>{}})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(U.pm),e.Y36(a.qu),e.Y36(A.B),e.Y36(Z._W))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-change-password"]],hostBindings:function(t,n){1&t&&e.NdJ("beforeunload",function(d){return n.unloadNotification(d)},!1,e.Jf7)},decls:8,vars:11,consts:[[3,"formGroup","ngSubmit"],[1,"row"],[1,"col-12","col-sm-10","col-md-6","col-lg-4"],[3,"label","formControl","type"],["type","submit",1,"btn","btn-success",3,"disabled"]],template:function(t,n){1&t&&(e.TgZ(0,"form",0),e.NdJ("ngSubmit",function(){return n.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2),e._UZ(3,"app-text-input",3)(4,"app-text-input",3)(5,"app-text-input",3),e.qZA()(),e.TgZ(6,"button",4),e._uU(7,"Submit"),e.qZA()()),2&t&&(e.Q6J("formGroup",n.passwordForm),e.xp6(3),e.Q6J("label","Current password")("formControl",n.passwordForm.controls.currentPassword)("type","password"),e.xp6(1),e.Q6J("label","New password")("formControl",n.passwordForm.controls.newPassword)("type","password"),e.xp6(1),e.Q6J("label","Repeat password")("formControl",n.passwordForm.controls.repeatNewPassword)("type","password"),e.xp6(1),e.Q6J("disabled",n.passwordForm.invalid))},dependencies:[T.t,a._Y,a.JJ,a.JL,a.oH,a.sg]}),s})();var m=r(1584);function v(s,i){if(1&s&&(e.TgZ(0,"div"),e._UZ(1,"app-user-card",1),e.qZA()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("user",t)}}let x=(()=>{class s{constructor(t){this.userService=t,this.users=[]}ngOnInit(){this.loadSavedProfiles()}loadSavedProfiles(){this.userService.getSavedUsers().subscribe({next:t=>{this.users=t}})}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(m.K))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-saved-profiles"]],decls:1,vars:1,consts:[[4,"ngFor","ngForOf"],[3,"user"]],template:function(t,n){1&t&&e.YNc(0,v,2,1,"div",0),2&t&&e.Q6J("ngForOf",n.users)},dependencies:[o.sg,g.r]}),s})(),y=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-account-products"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[h.lC]}),s})(),F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-services"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[h.lC]}),s})();var w=r(5861),_=r(4407),L=r(5079),Y=r(2340),H=r(1135),k=r(5698),z=r(529),q=r(9978);let G=(()=>{class s{constructor(t,n){this.http=t,this.busyService=n,this.baseUrl=Y.N.apiUrl,this.hubUrl=Y.N.hubUrl,this.messageThreadSource=new H.X([]),this.messageThread$=this.messageThreadSource.asObservable()}createHubConnection(t,n){this.busyService.busy(),this.hubConnection=(new _.s).withUrl(this.hubUrl+"message?user="+n,{accessTokenFactory:()=>t.token,transport:L.n.WebSockets}).withAutomaticReconnect().build(),this.hubConnection.start().catch(l=>console.log(l)).finally(()=>this.busyService.idle()),this.hubConnection.on("ReceiveMessageThread",l=>{this.messageThreadSource.next(l)}),this.hubConnection.on("UpdatedGroup",l=>{l.connections.some(d=>d.username===n)&&this.messageThread$.pipe((0,k.q)(1)).subscribe({next:d=>{d.forEach(b=>{b.dateRead||(b.dateRead=new Date(Date.now()))}),this.messageThreadSource.next([...d])}})}),this.hubConnection.on("NewMessage",l=>{this.messageThread$.pipe((0,k.q)(1)).subscribe({next:d=>{this.messageThreadSource.next([...d,l])}})})}stopHubConnection(){this.hubConnection&&(this.messageThreadSource.next([]),this.hubConnection.stop())}getMessageThread(t){return this.http.get(this.baseUrl+"messages/thread/"+t)}sendMessage(t,n){var l=this;return(0,w.Z)(function*(){return l.hubConnection?.invoke("SendMessage",{recipientUsername:t,content:n}).catch(d=>console.log(d))})()}deleteMessage(t){return this.http.delete(this.baseUrl+"messages/"+t)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(z.eN),e.LFG(q.z))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();const j=["messageForm"];function $(s,i){1&s&&(e.ynx(0),e.TgZ(1,"p",22),e._uU(2,"online"),e.qZA(),e.BQk())}const R=function(s,i){return{"text-blue":s,"text-muted":i}};function K(s,i){if(1&s&&(e.TgZ(0,"span"),e._UZ(1,"i",30),e.qZA()),2&s){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngClass",e.WLB(1,R,void 0!==t.dateRead,void 0===!t.dateRead))}}const W=function(s,i){return{"justify-content-start":s,"justify-content-end":i}},V=function(s,i){return{"bg-white":s,"bg-success":i}};function X(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div")(1,"div",23)(2,"div",5)(3,"div",24)(4,"div"),e._uU(5),e.qZA(),e.TgZ(6,"div",25)(7,"span",26),e._uU(8),e.ALo(9,"date"),e.qZA(),e.YNc(10,K,2,4,"span",10),e.qZA(),e.TgZ(11,"ul",27)(12,"li")(13,"a",28),e.NdJ("click",function(){const d=e.CHM(t).$implicit,b=e.oxw(2);return e.KtG(b.deleteMessage(d.id))}),e._UZ(14,"i",29),e._uU(15," Delete message"),e.qZA()()()()()()()}if(2&s){const t=i.$implicit,n=e.oxw(2);e.xp6(1),e.Q6J("ngClass",e.WLB(8,W,!n.isMyChat(t),n.isMyChat(t))),e.xp6(2),e.Q6J("ngClass",e.WLB(11,V,!n.isMyChat(t),n.isMyChat(t))),e.xp6(2),e.hij(" ",t.content," "),e.xp6(3),e.hij(" ",e.xi3(9,5,t.messageSent,"shortTime")," "),e.xp6(2),e.Q6J("ngIf",n.isMyChat(t))}}function ee(s,i){1&s&&e._UZ(0,"i",31)}function te(s,i){1&s&&e._UZ(0,"i",32)}function oe(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"div",3)(3,"div",4)(4,"div",5),e._UZ(5,"img",6),e.qZA(),e.TgZ(6,"div",7)(7,"div")(8,"h3",8)(9,"a",9),e._uU(10),e.qZA()(),e.YNc(11,$,3,0,"ng-container",10),e.ALo(12,"async"),e.qZA()()()()(),e.TgZ(13,"div",11),e.YNc(14,X,16,14,"div",12),e.ALo(15,"async"),e.qZA(),e.TgZ(16,"div",13)(17,"form",14,15),e.NdJ("ngSubmit",function(){e.CHM(t);const l=e.oxw();return e.KtG(l.sendMessage())}),e.TgZ(19,"div",16)(20,"div",17)(21,"input",18),e.NdJ("ngModelChange",function(l){e.CHM(t);const d=e.oxw();return e.KtG(d.messageContent=l)}),e.qZA()(),e.TgZ(22,"div",5)(23,"button",19),e.YNc(24,ee,1,0,"i",20),e.YNc(25,te,1,0,"i",21),e.qZA()()()()()()}if(2&s){const t=e.MAs(18),n=e.oxw();let l;e.xp6(5),e.s9C("src",n.recipient.photoUrl,e.LSH),e.xp6(4),e.MGl("routerLink","/user/",n.recipient.id,""),e.xp6(1),e.hij(" ",n.recipient.fullName," "),e.xp6(1),e.Q6J("ngIf",null==(l=e.lcZ(12,9,n.presenceService.onlineUsers$))?null:l.includes(n.recipient.userName)),e.xp6(3),e.Q6J("ngForOf",e.lcZ(15,11,n.messageService.messageThread$)),e.xp6(7),e.Q6J("ngModel",n.messageContent),e.xp6(2),e.Q6J("disabled",!t.valid||n.loading),e.xp6(1),e.Q6J("ngIf",!n.loading),e.xp6(1),e.Q6J("ngIf",n.loading)}}let se=(()=>{class s{constructor(t,n,l,d,b,E,Q){this.messageService=t,this.route=n,this.presenceService=l,this.bcService=d,this.userService=b,this.toastr=E,this.confirmService=Q,this.messageContent="",this.loading=!1,this.modal=new C.u;const pe=localStorage.getItem("account");this.account=JSON.parse(pe),this.recipientEmail=this.route.snapshot.paramMap.get("username")}ngOnInit(){this.messageService.createHubConnection(this.account,this.recipientEmail),this.loadRecipient()}loadRecipient(){this.userService.getUserByEmail(this.recipientEmail).subscribe({next:t=>this.recipient=t})}ngOnDestroy(){this.messageService.stopHubConnection()}sendMessage(){this.recipientEmail&&(this.loading=!0,this.messageService.sendMessage(this.recipientEmail,this.messageContent).then(()=>{this.messageForm?.reset()}).finally(()=>this.loading=!1))}deleteMessage(t){this.modal.title="Delete message",this.modal.message="Are you sure to delete this message?",this.confirmService.confirm(this.modal).subscribe({next:n=>{n&&this.messageService.deleteMessage(t).subscribe({next:()=>this.toastr.success("Message deleted"),complete:()=>this.ngOnInit()})}})}isMyChat(t){return t.recipientUsername===this.recipientEmail}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(G),e.Y36(h.gz),e.Y36(p.Q),e.Y36(U.pm),e.Y36(m.K),e.Y36(Z._W),e.Y36(f.z))},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-messages"]],viewQuery:function(t,n){if(1&t&&e.Gf(j,5),2&t){let l;e.iGM(l=e.CRH())&&(n.messageForm=l.first)}},decls:1,vars:1,consts:[["class","card shadow-sm rounded-4",4,"ngIf"],[1,"card","shadow-sm","rounded-4"],[1,"card-header"],[1,"d-flex","align-items-center"],[1,"row"],[1,"col-auto"],[1,"img-fluid","rounded-circle",3,"src"],[1,"col","d-flex","align-items-center"],[1,"lh-1"],[1,"text-decoration-none","text-dark",3,"routerLink"],[4,"ngIf"],[1,"card-body","bg-messenger","overflow-scroll"],[4,"ngFor","ngForOf"],[1,"card-footer"],["autocomplete","off",3,"ngSubmit"],["messageForm","ngForm"],[1,"row","d-flex","justify-content-between"],[1,"col"],["name","messageContent","required","","type","text","placeholder","Send a private message",1,"form-control","form-control-info","input-sm","rounded-pill",3,"ngModel","ngModelChange"],["type","submit",1,"btn","btn-info","rounded-circle",3,"disabled"],["class","fa fa-send",4,"ngIf"],["class","fa fa-spinner fa-spin",4,"ngIf"],[1,"lh-1","mb-0"],[1,"row","d-flex",3,"ngClass"],[1,"px-3","py-2","mb-2","rounded-4","shadow-sm","dropdown",3,"ngClass"],["type","button","data-bs-toggle","dropdown",1,"text-end","text-muted","pointer","d-flex","align-items-center","justify-content-end"],[1,"me-1",2,"font-size","12px"],[1,"dropdown-menu","dropdown-menu-dark","shadow"],[1,"dropdown-item","pointer",3,"click"],[1,"fa","fa-trash","me-2","text-danger"],[1,"bi","bi-check-all",3,"ngClass"],[1,"fa","fa-send"],[1,"fa","fa-spinner","fa-spin"]],template:function(t,n){1&t&&e.YNc(0,oe,26,13,"div",0),2&t&&e.Q6J("ngIf",n.recipient)},dependencies:[o.mk,o.sg,o.O5,h.rH,a._Y,a.Fj,a.JJ,a.JL,a.Q7,a.On,a.F,o.Ov,o.uU],styles:["img[_ngcontent-%COMP%]{max-width:60px}.bg-success[_ngcontent-%COMP%]{background-color:#dcfbc5!important}.card-body[_ngcontent-%COMP%]{max-height:55vh!important;min-height:55vh!important;overflow-x:hidden!important}*[_ngcontent-%COMP%]{scrollbar-width:auto;scrollbar-color:#969696 #ffffff}*[_ngcontent-%COMP%]::-webkit-scrollbar{width:16px}*[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}*[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background-color:#969696;border-radius:10px;border:4px solid #e8e9e9!important}.bg-messenger[_ngcontent-%COMP%]{background-color:#e8e9e9!important}.text-blue[_ngcontent-%COMP%]{color:#08a9d9!important}"]}),s})();var D=r(9646);let ne=(()=>{class s{constructor(t){this.confirmService=t,this.modal=new C.u,this.modal.title="Leave password reset process",this.modal.message="Are you sure to lose your password reset progress"}canDeactivate(t){return t.passwordForm?.touched?this.confirmService.confirm(this.modal):(0,D.of)(!0)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(f.z))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),re=(()=>{class s{constructor(t){this.confirmService=t,this.modal=new C.u,this.modal.title="Lose unsaved changes?",this.modal.message="Are you sure to lose the unsaved changes made to your account?"}canDeactivate(t){return t.userForm?.dirty?this.confirmService.confirm(this.modal):(0,D.of)(!0)}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(f.z))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})(),ie=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["app-jobs"]],decls:1,vars:0,template:function(t,n){1&t&&e._UZ(0,"router-outlet")},dependencies:[h.lC]}),s})();const ce=[{path:"summary",canActivate:[r(7574).a],component:c},{path:"edit",component:N,data:{breadcrumb:{alias:"editProfileTitle"}},canDeactivate:[re]},{path:"products",component:y,loadChildren:()=>Promise.all([r.e(592),r.e(247)]).then(r.bind(r,7247)).then(s=>s.AccountProductsModule)},{path:"services",component:F,loadChildren:()=>Promise.all([r.e(592),r.e(135)]).then(r.bind(r,5135)).then(s=>s.ServicesModule)},{path:"jobs",component:ie,loadChildren:()=>Promise.all([r.e(592),r.e(541)]).then(r.bind(r,8541)).then(s=>s.JobsModule)},{path:"messages/:username",component:se,loadChildren:()=>r.e(95).then(r.bind(r,2095)).then(s=>s.MessagesModule)},{path:"saved-profiles",component:x},{path:"change-password",component:u,data:{breadcrumb:{alias:"changePassword"}},canDeactivate:[ne]}];let le=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[h.Bz.forChild(ce),h.Bz]}),s})();var ue=r(4466);let de=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[o.ez,le,ue.m,a.u5]}),s})()},2699:(B,S,r)=>{r.d(S,{N:()=>N});var o=r(1571),h=r(1129),a=r(2340),C=r(2559),e=r(5329),A=r(5528),U=r(7185),Z=r(6325),f=r(6895);function T(p,g){if(1&p){const c=o.EpF();o.TgZ(0,"div",9),o._UZ(1,"img",10),o.TgZ(2,"div",11)(3,"button",12),o.NdJ("click",function(){const v=o.CHM(c).$implicit,x=o.oxw();return o.KtG(x.delete(v.id))}),o.qZA()()()}if(2&p){const c=g.$implicit;o.xp6(1),o.s9C("src",c.url,o.LSH)}}function M(p,g){if(1&p&&(o.TgZ(0,"td",26),o._uU(1),o.ALo(2,"number"),o.qZA()),2&p){const c=o.oxw().$implicit;o.xp6(1),o.hij(" ",o.xi3(2,1,(null==c||null==c.file?null:c.file.size)/1024/1024,".2")," MB ")}}function J(p,g){if(1&p&&(o.TgZ(0,"tr")(1,"td")(2,"strong"),o._uU(3),o.qZA()(),o.YNc(4,M,3,4,"td",25),o.qZA()),2&p){const c=g.$implicit,u=o.oxw(2);o.xp6(3),o.Oqu(null==c||null==c.file?null:c.file.name),o.xp6(1),o.Q6J("ngIf",null==u.uploader||null==u.uploader.options?null:u.uploader.options.isHTML5)}}const P=function(p){return{width:p}};function I(p,g){if(1&p){const c=o.EpF();o.TgZ(0,"div",13)(1,"h3"),o._uU(2,"Upload queue"),o.qZA(),o.TgZ(3,"p"),o._uU(4),o.qZA(),o.TgZ(5,"table",14)(6,"thead")(7,"tr")(8,"th",15),o._uU(9,"Name"),o.qZA(),o.TgZ(10,"th"),o._uU(11,"Size"),o.qZA()()(),o.TgZ(12,"tbody"),o.YNc(13,J,5,2,"tr",16),o.qZA()(),o.TgZ(14,"div")(15,"div",5)(16,"div",17),o._UZ(17,"div",18),o.qZA()(),o.TgZ(18,"div",5)(19,"button",19),o.NdJ("click",function(){o.CHM(c);const m=o.oxw();return o.KtG(null==m.uploader?null:m.uploader.uploadAll())}),o._UZ(20,"span",20),o._uU(21," Upload all "),o.qZA(),o.TgZ(22,"button",21),o.NdJ("click",function(){o.CHM(c);const m=o.oxw();return o.KtG(null==m.uploader?null:m.uploader.cancelAll())}),o._UZ(23,"span",22),o._uU(24," Cancel all "),o.qZA(),o.TgZ(25,"button",23),o.NdJ("click",function(){o.CHM(c);const m=o.oxw();return o.KtG(null==m.uploader?null:m.uploader.clearQueue())}),o._UZ(26,"span",24),o._uU(27," Remove all "),o.qZA()()()()}if(2&p){const c=o.oxw();let u;o.xp6(4),o.hij("Queue length: ",null==c.uploader||null==c.uploader.queue?null:c.uploader.queue.length,""),o.xp6(9),o.Q6J("ngForOf",c.uploader.queue),o.xp6(4),o.Q6J("ngStyle",o.VKq(6,P,(null==c.uploader?null:c.uploader.progress)+"%")),o.xp6(2),o.Q6J("disabled",!(null!=c.uploader&&null!=(u=c.uploader.getNotUploadedItems())&&u.length)),o.xp6(3),o.Q6J("disabled",!(null!=c.uploader&&c.uploader.isUploading)),o.xp6(3),o.Q6J("disabled",!(null!=c.uploader&&null!=c.uploader.queue&&c.uploader.queue.length))}}const O=function(p){return{"nv-file-over":p}};let N=(()=>{class p{constructor(c,u,m,v,x){this.route=c,this.accountService=u,this.productService=m,this.toastr=v,this.serviceService=x,this.send=new o.vpe,this.controller="",this.photos=[],this.hasBaseDropzoneOver=!1,this.baseUrl=a.N.apiUrl,this.url="",this.id=Number(this.route.snapshot.paramMap.get("id"))}ngOnInit(){switch(this.controller){case"products":case"services":this.url=`${this.controller}/photo/${this.id}`;break;case"account":this.url=`${this.controller}/photo/${this.userId}`}this.initializeUploader()}initializeUploader(){const c=this.accountService.getAccountToken();this.uploader=new h.bA({url:this.baseUrl+this.url,authToken:"Bearer "+c,isHTML5:!0,allowedFileType:["image"],removeAfterUpload:!0,autoUpload:!1,maxFileSize:10670080}),this.uploader.onAfterAddingFile=u=>{u.withCredentials=!1},this.uploader.onSuccessItem=(u,m,v,x)=>{if(m)switch(this.controller){case"services":const y=JSON.parse(m);this.object=y,this.send.emit(this.object),this.photos=[],y.servicePhotos.forEach(_=>{this.photos.push(_.photo)});break;case"products":const F=JSON.parse(m);this.object=F,this.send.emit(this.object),this.photos=[],F.productPhotos.forEach(_=>{this.photos.push(_.photo)});break;case"account":const w=JSON.parse(m);this.object=w,this.send.emit(this.object),this.photos=[],this.photos.push(w.appUserPhoto.photo)}}}delete(c){switch(this.controller){case"services":this.serviceService.deletePhoto(c,+this.id).subscribe({next:u=>{this.object=u,this.photos=[],u.servicePhotos.forEach(m=>{this.photos.push(m.photo)}),this.send.emit(u),this.toastr.success("Photo deleted successfully")}});break;case"products":this.productService.deletePhoto(c,+this.id).subscribe({next:u=>{this.object=u,this.photos=[],u.productPhotos.forEach(m=>{this.photos.push(m.photo)}),this.send.emit(u),this.toastr.success("Photo deleted successfully")}});break;case"account":this.accountService.removePhoto(this.userId).subscribe({next:()=>{this.photos=[],this.toastr.success("Photo deleted successfully")}})}}fileOverBase(c){this.hasBaseDropzoneOver=c}}return p.\u0275fac=function(c){return new(c||p)(o.Y36(C.gz),o.Y36(e.B),o.Y36(A.M),o.Y36(U._W),o.Y36(Z.r))},p.\u0275cmp=o.Xpm({type:p,selectors:[["app-photo-upload"]],inputs:{object:"object",controller:"controller",photos:"photos",userId:"userId"},outputs:{send:"send"},decls:12,vars:7,consts:[[1,"row","mb-3"],["class","col-6 col-sm-4 col-md-3",4,"ngFor","ngForOf"],[1,"col-12","col-md-3"],["ng2FileDrop","",1,"card","bg-faded","p-3","text-center","mb-3","my-drop-zone",3,"ngClass","uploader","fileOver"],[1,"fa","fa-upload","fa-3x"],[1,"mb-3"],["for","formFile",1,"form-label"],["type","file","id","formFile","ng2FileSelect","","multiple","",1,"form-control",3,"uploader"],["class","col-12 col-md-9","style","margin-bottom: 40px",4,"ngIf"],[1,"col-6","col-sm-4","col-md-3"],[1,"img-thumbnail","mb-1",3,"src"],[1,"text-center"],[1,"btn","btn-close",3,"click"],[1,"col-12","col-md-9",2,"margin-bottom","40px"],[1,"table"],["width","100%"],[4,"ngFor","ngForOf"],[1,"progress"],["role","progressbar",1,"progress-bar","progress-bar-striped","progress-bar-animated",3,"ngStyle"],["type","button",1,"btn","btn-outline-success","me-2","btn-sm",3,"disabled","click"],[1,"fa","fa-upload"],["type","button",1,"btn","btn-outline-warning","me-2","btn-sm",3,"disabled","click"],[1,"fa","fa-ban"],["type","button",1,"btn","btn-outline-danger","me-2","btn-sm",3,"disabled","click"],[1,"fa","fa-trash"],["nowrap","",4,"ngIf"],["nowrap",""]],template:function(c,u){1&c&&(o.ynx(0),o.TgZ(1,"div",0),o.YNc(2,T,4,1,"div",1),o.qZA(),o.BQk(),o.TgZ(3,"div",2)(4,"div",3),o.NdJ("fileOver",function(v){return u.fileOverBase(v)}),o._UZ(5,"i",4),o._uU(6,"Drop photos here "),o.qZA(),o.TgZ(7,"div",5)(8,"label",6),o._uU(9,"Fotos"),o.qZA(),o._UZ(10,"input",7),o.qZA()(),o.YNc(11,I,28,8,"div",8)),2&c&&(o.xp6(2),o.Q6J("ngForOf",u.photos),o.xp6(2),o.Q6J("ngClass",o.VKq(5,O,u.hasBaseDropzoneOver))("uploader",u.uploader),o.xp6(6),o.Q6J("uploader",u.uploader),o.xp6(1),o.Q6J("ngIf",null==u.uploader||null==u.uploader.queue?null:u.uploader.queue.length))},dependencies:[f.mk,f.sg,f.O5,f.PC,h.GN,h.C6,f.JJ]}),p})()}}]);